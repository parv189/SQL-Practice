--USE SQL_Practice2;
--GO
CREATE TABLE employee2 (
EMPLOYEE_ID DECIMAL(2,0),
FIRST_NAME VARCHAR(20),
LAST_NAME VARCHAR(20),
SALARY DECIMAL(8,0),
JOINING_DATE DATE,
Birth_Date DATE,
phone_number VARCHAR(10),
);

INSERT INTO employee2 VALUES (1,'John','braham',100000,'1985-05-20','1963-07-21','9846736284'),
(2, 'Michael','Clarke',82000, '1987-06-20','1962-03-27','9287598475'),
(3, 'Roy', 'Thomas', 70000, '1991-02-03','1968-05-10','8793785746'),
(4, 'Tom', 'Jose', 68000,'1995-07-04','1970-06-08','6789450983'),
(5, 'Jerry', 'Pinto', 650000, '1987-07-05','1955-12-15','7893745986'),
(6, 'Philip', 'Mathew', 750000, '1990-11-26','1965-03-13','9784536725'),
(7, 'Morcal', 'Devine', 65000, '1980-04-21','1956-09-07','8976574839'),
(8, 'Stark', 'Burns', 50000, '2000-08-01','1977-10-18','9876548934');
	

--DROP TABLE employee2;
SELECT * FROM employee2;

SELECT FIRST_NAME,LEN(FIRST_NAME) 'Length' FROM employee2 
WHERE LEFT(FIRST_NAME,1) = 'A' OR LEFT(FIRST_NAME,1) = 'J' OR LEFT(FIRST_NAME,1) = 'M' ORDER BY FIRST_NAME;		

SELECT FIRST_NAME,RIGHT('$$$$$'+CONVERT(VARCHAR(10),SALARY),10) Padded_Salary FROM employee2;
SELECT FIRST_NAME,CONCAT(REPLICATE('$',10 - LEN(SALARY)),SALARY) Padded_Salary FROM employee2;

SELECT FIRST_NAME,LAST_NAME,JOINING_DATE FROM employee2 
WHERE DAY(JOINING_DATE) = '07' OR MONTH(JOINING_DATE) = '07';

SELECT LEN(FIRST_NAME) LENGTH FROM employee2 WHERE CHARINDEX('c',LAST_NAME,3) <> 0;

SELECT RIGHT(phone_number,4) Last_4_of_phn FROM employee2;

UPDATE employee2 SET phone_number = REPLACE(phone_number,'123','999');

SELECT DATEDIFF(year,Birth_Date,GETDATE()) AGE FROM employee2;

SELECT DISTINCT DATENAME(WEEKDAY,Birth_Date) Mondayes FROM employee2 
WHERE DATENAME(WEEKDAY,Birth_Date) = 'Monday';

SELECT FIRST_NAME,JOINING_DATE FROM employee2 WHERE JOINING_DATE 
BETWEEN '1987-06-01' AND '1987-07-30';

SELECT FORMAT(GETDATE(),'hh:mm AM/PM Mon dd,yyyy');

SELECT FIRST_NAME,LAST_NAME FROM employee2 WHERE MONTH(JOINING_DATE) = '6';

SELECT EMPLOYEE_ID,LAST_NAME,DATEADD(dd,36,JOINING_DATE) D_Of_F_Salary FROM employee2;

SELECT FIRST_NAME,JOINING_DATE,DATEDIFF(YY,JOINING_DATE,GETDATE()) Experience FROM employee2;

SELECT FIRST_NAME FROM employee2 WHERE YEAR(JOINING_DATE) = 1987;

SELECT *,RANK()OVER(ORDER BY SALARY DESC) 'RANK' FROM employee2;
SELECT *,DENSE_RANK()OVER(ORDER BY SALARY DESC) 'RANK' FROM employee2;
SELECT *,ROW_NUMBER()OVER(ORDER BY SALARY DESC) 'RANK' FROM employee2;      /*PARTITION BY*/

SELECT *,RANK()OVER(ORDER BY SALARY DESC) 'rank' FROM employee2 ;

WITH Rank
AS (SELECT *,RANK()OVER(ORDER BY SALARY DESC) 'rank1' FROM employee2 AS DTB)					/*we can,t use WHERE on SELECTED part so fist we have to derived it*/
SELECT * FROM Rank WHERE rank1 = 4;